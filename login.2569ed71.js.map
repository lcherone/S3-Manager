{"version":3,"sources":["src/pages/login.vue"],"names":[],"mappings":";;;;;;;AAyCA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,KAAA,EAAA,CAAA,OAAA,CAFA;AAGA,EAAA,UAAA,EAAA,EAHA;AAIA,EAAA,IAAA,EAAA,gBAAA;AACA,WAAA;AACA,MAAA,IAAA,EAAA;AACA,QAAA,MAAA,EAAA,EADA;AAEA,QAAA,MAAA,EAAA;AACA,UAAA,QAAA,EAAA,EADA;AAEA,UAAA,YAAA,EAAA;AAFA;AAFA;AADA,KAAA;AASA,GAdA;AAeA,EAAA,WAfA,yBAeA;AACA,QACA,OAAA,YAAA,CAAA,QAAA,KAAA,WAAA,IACA,OAAA,YAAA,CAAA,KAAA,KAAA,WAFA,EAGA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,QAAA;AACA;AACA,GAtBA;AAuBA,EAAA,OAAA,EAAA;AACA,IAAA,KADA,mBACA;AACA,aAAA,YAAA,CAAA,QAAA;AACA,aAAA,YAAA,CAAA,KAAA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,QAAA;AACA,KALA;AAMA,IAAA,MANA,oBAMA;AACA,WAAA,IAAA,CAAA,MAAA,GAAA,EAAA,CADA,CAGA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,MAAA,CAAA,QAAA,EAAA;AACA,aAAA,IAAA,CAAA,MAAA,CAAA,QAAA,GAAA,+BAAA;AACA,OAFA,MAEA,IAAA,CAAA,KAAA,eAAA,CAAA,KAAA,IAAA,CAAA,MAAA,CAAA,QAAA,CAAA,EAAA;AACA,aAAA,IAAA,CAAA,MAAA,CAAA,QAAA,GAAA,mFAAA;AACA;;AAEA,UAAA,MAAA,CAAA,IAAA,CAAA,KAAA,IAAA,CAAA,MAAA,EAAA,MAAA,EAAA;AACA;AACA,OAZA,CAcA;;;AACA,UAAA,KAAA;;AACA,UAAA;AACA;AACA,QAAA,KAAA,GAAA,aAAA,OAAA,CAAA,YAAA,CAAA,KAAA,EAAA,KAAA,IAAA,CAAA,MAAA,CAAA,QAAA,EAAA,QAAA,CAAA,eAAA,CAAA,CAFA,CAIA;;AACA,QAAA,KAAA,GAAA,IAAA,CAAA,KAAA,CAAA,KAAA,CAAA;AAEA,OAPA,CAOA,OAAA,CAAA,EAAA;AACA,aAAA,IAAA,CAAA,MAAA,CAAA,QAAA,GAAA,6CAAA;AACA,aAAA,IAAA,CAAA,MAAA,CAAA,QAAA,GAAA,EAAA;AACA,eAAA,KAAA;AACA,OA3BA,CA6BA;;;AACA,sCAAA,MAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AAAA,YAAA,GAAA,mBAAA;AACA,aAAA,IAAA,CAAA,KAAA,KAAA,EAAA,GAAA,EAAA,KAAA,CAAA,GAAA,CAAA;AADA,OA9BA,CAiCA;;;AACA,WAAA,IAAA,CAAA,KAAA,KAAA,EAAA,MAAA,EAAA,EAAA,EAlCA,CAoCA;;AACA,WAAA,IAAA,CAAA,KAAA,KAAA,EAAA,SAAA,EAAA,IAAA,EArCA,CAuCA;;AACA,WAAA,IAAA,CAAA,KAAA,KAAA,EAAA,UAAA,EAAA,KAAA,IAAA,CAAA,MAAA,CAAA,QAAA;AAEA,WAAA,OAAA,CAAA,IAAA,CAAA,GAAA;AACA,aAAA,IAAA;AACA,KAlDA;AAmDA,IAAA,eAnDA,2BAmDA,QAnDA,EAmDA;AACA,UAAA,EAAA,GAAA,qEAAA;AACA,aAAA,EAAA,CAAA,IAAA,CAAA,QAAA,CAAA;AACA;AAtDA;AAvBA","file":"login.2569ed71.js","sourceRoot":"..","sourcesContent":["<template>\n  <article class=\"container-fluid py-5\">\n    <div class=\"row\">\n      <div class=\"col-12 col-md-8 col-lg-6 col-xl-4 mx-auto\">\n        <div class=\"bg-white shadow p-4\">\n          <h1 class=\"h3 pb-2 border-bottom\">\n            <fa icon=\"lock\"></fa>&nbsp;Login\n          </h1>\n          <p class=\"text-center py-2\">Welcome back! Enter your password to unlock your hosts.</p>\n\n          <form class=\"px-3\" @submit.prevent=\"submit\" no-validate>\n            <div class=\"form-group\">\n              <label>Password</label>\n              <input\n                type=\"password\"\n                :class=\"['form-control', {'is-invalid': form.errors.password}]\"\n                v-model=\"form.values.password\"\n                placeholder=\"Enter secure passwordâ€¦\"\n              />\n              <div class=\"invalid-feedback\" v-if=\"form.errors.password\">{{ form.errors.password }}</div>\n            </div>\n            <div class=\"row\">\n              <div class=\"col text-left\">\n                <div class=\"form-group\">\n                  <button type=\"button\" class=\"btn btn-danger\" @click=\"reset\">Reset</button>\n                </div>\n              </div>\n              <div class=\"col text-right\">\n                <div class=\"form-group\">\n                  <button type=\"submit\" class=\"btn btn-success\">Login</button>\n                </div>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </article>\n</template>\n\n<script>\nimport CryptoAES from 'crypto-js/aes'\nimport CryptoUTF8 from 'crypto-js/enc-utf8'\n\nexport default {\n  name: \"login\",\n  props: ['state'],\n  components: {},\n  data: function () {\n    return {\n      form: {\n        errors: {},\n        values: {\n          password: '',\n          password_rpt: ''\n        }\n      }\n    }\n  },\n  beforeMount() {\n    if (\n      typeof localStorage.auth_set === 'undefined' ||\n      typeof localStorage.state === 'undefined'\n    ) {\n      this.$router.push('/setup')\n    }\n  },\n  methods: {\n    reset() {\n      delete localStorage.auth_set\n      delete localStorage.state\n      this.$router.push('/setup')\n    },\n    submit() {\n      this.form.errors = {}\n\n      //\n      if (!this.form.values.password) {\n        this.form.errors.password = 'Password is a required field.'\n      } else if (!this.isValidPassword(this.form.values.password)) {\n        this.form.errors.password = '>= 8 characters, at least 1 upper & lower case and a number or special character.'\n      }\n\n      if (Object.keys(this.form.errors).length) {\n        return\n      }\n\n      // attempt to decrypt state\n      let state\n      try {\n        // decrypt\n        state = CryptoAES.decrypt(localStorage.state, this.form.values.password).toString(CryptoUTF8)\n\n        // json parse\n        state = JSON.parse(state)\n\n      } catch (e) {\n        this.form.errors.password = 'Invalid data or password, please try again.'\n        this.form.values.password = ''\n        return false\n      }\n\n      //\n      for (let key of Object.keys(state))\n        this.$set(this.state, key, state[key])\n\n      //\n      this.$set(this.state, 'host', {})\n\n      //\n      this.$set(this.state, 'loading', true)\n\n      // set password into state for saving\n      this.$set(this.state, 'password', this.form.values.password)\n\n      this.$router.push('/')\n      return true\n    },\n    isValidPassword(password) {\n      var re = /(?=^.{8,256}$)((?=.*\\d)|(?=.*\\W+))(?![.\\n])(?=.*[A-Z])(?=.*[a-z]).*/\n      return re.test(password)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n"]}